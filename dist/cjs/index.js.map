{"version":3,"file":"index.js","sources":["../../src/components/Anchor.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, ReactNode, useCallback, CSSProperties } from 'react';\n\n/**\n * Interface for a single anchor item\n * @interface AnchorItem\n * @property {string} href - The target href for the anchor item\n * @property {ReactNode | ((isActive: boolean, level: number) => ReactNode)} content - The content to be rendered for this item. Can be a ReactNode or a function that returns a ReactNode\n * @property {AnchorItem[]} [children] - Optional array of child anchor items\n */\ninterface AnchorItem {\n  href: string;\n  content: ReactNode | ((isActive: boolean, level: number) => ReactNode);\n  children?: AnchorItem[];\n}\n\n/**\n * Props for the EaseAnchor component\n * @interface EaseAnchorProps\n * @property {AnchorItem[]} items - Array of anchor items to be rendered\n * @property {string | HTMLElement} [scrollContainer] - The container to which the scroll event listener is attached. Can be a CSS selector string or an HTMLElement\n * @property {number} [offset=8] - The offset distance to the top of the container\n * @property {number} [targetOffset=0] - The offset distance to the target element\n * @property {boolean} [animation=true] - Whether to use smooth scrolling animation\n * @property {(currentActiveHref: string) => void} [onChange] - Callback function that is called when the active anchor changes\n * @property {string} [className] - Additional CSS class name for the component\n * @property {React.CSSProperties} [style] - Additional inline styles for the component\n * @property {boolean} [hashMode=false] - Whether to use hash mode for URLs\n * @property {string} [defaultValue] - The default active href (for uncontrolled component)\n * @property {string} [value] - The controlled active href (for controlled component)\n */\ninterface EaseAnchorProps {\n  items: AnchorItem[];\n  scrollContainer?: string | HTMLElement;\n  offset?: number;\n  targetOffset?: number;\n  animation?: boolean;\n  onChange?: (currentActiveHref: string) => void;\n  className?: string;\n  style?: CSSProperties;\n  hashMode?: boolean;\n  defaultValue?: string;\n  value?: string;\n}\n\ntype ScrollContainer = Window | HTMLElement;\n\nconst EaseAnchor: React.FC<EaseAnchorProps> = ({\n  items,\n  scrollContainer,\n  offset = 8,\n  targetOffset = 0,\n  animation = true,\n  onChange,\n  className = '',\n  style = {},\n  hashMode = false,\n  defaultValue,\n  value,\n}) => {\n  const [activeHref, setActiveHref] = useState<string>('');\n  const containerRef = useRef<HTMLElement | null>(null);\n  const initialScrollDone = useRef<boolean>(false);\n\n  const getInitialActiveHref = useCallback(() => {\n    if (value !== undefined) return value;\n    if (defaultValue) return defaultValue;\n    if (hashMode) {\n      const hash = window.location.hash;\n      return hash ? hash : '';\n    }\n    return '';\n  }, [value, defaultValue, hashMode]);\n\n  useEffect(() => {\n    setActiveHref(getInitialActiveHref());\n  }, [getInitialActiveHref]);\n\n  const handleScroll = useCallback(() => {\n    if (!containerRef.current || value !== undefined) return;\n\n    let currentActiveHref = '';\n    for (const item of items) {\n      const targetHref = hashMode ? `#${item.href.replace(/^#/, '')}` : item.href;\n      const element = document.querySelector(targetHref);\n      if (element && element.getBoundingClientRect().top <= targetOffset + offset) {\n        currentActiveHref = targetHref;\n      } else {\n        break;\n      }\n    }\n\n    if (currentActiveHref !== activeHref) {\n      setActiveHref(currentActiveHref);\n      onChange && onChange(currentActiveHref);\n      if (hashMode) {\n        window.history.replaceState(null, '', currentActiveHref);\n      }\n    }\n  }, [items, offset, targetOffset, activeHref, onChange, hashMode, value]);\n\n  useEffect(() => {\n    try {\n      const container = typeof scrollContainer === 'string'\n        ? document.querySelector(scrollContainer)\n        : scrollContainer || window;\n\n      containerRef.current = container as HTMLElement;\n\n      if (!containerRef.current) {\n        throw new Error('Invalid scroll container');\n      }\n\n      containerRef.current.addEventListener('scroll', handleScroll);\n      handleScroll(); // Initial check\n\n      return () => {\n        containerRef.current?.removeEventListener('scroll', handleScroll);\n      };\n    } catch (error) {\n      console.error('Error setting up scroll listener:', error);\n    }\n  }, [scrollContainer, handleScroll]);\n\n  useEffect(() => {\n    if (!initialScrollDone.current && containerRef.current) {\n      const targetHref = getInitialActiveHref();\n      if (targetHref) {\n        const targetElement = document.querySelector(targetHref);\n        if (targetElement) {\n          const containerScrollTop = containerRef.current === window\n            ? window.pageYOffset\n            : (containerRef.current as HTMLElement).scrollTop;\n          const targetPosition = targetElement.getBoundingClientRect().top + containerScrollTop - offset - targetOffset;\n\n          if (animation) {\n            containerRef.current.scrollTo({\n              top: targetPosition,\n              behavior: 'smooth'\n            });\n          } else {\n            containerRef.current.scrollTo(0, targetPosition);\n          }\n\n          setActiveHref(targetHref);\n          onChange && onChange(targetHref);\n        }\n      }\n      initialScrollDone.current = true;\n    }\n  }, [getInitialActiveHref, offset, targetOffset, animation, onChange]);\n\n  const handleClick = useCallback((e: React.MouseEvent<HTMLElement>, href: string) => {\n    e.preventDefault();\n    const targetHref = hashMode ? `#${href.replace(/^#/, '')}` : href;\n    const targetElement = document.querySelector(targetHref);\n    if (targetElement && containerRef.current) {\n      const containerScrollTop = containerRef.current === window\n        ? window.pageYOffset\n        : (containerRef.current as HTMLElement).scrollTop;\n      const targetPosition = targetElement.getBoundingClientRect().top + containerScrollTop - offset - targetOffset;\n\n      if (animation) {\n        containerRef.current.scrollTo({\n          top: targetPosition,\n          behavior: 'smooth'\n        });\n      } else {\n        containerRef.current.scrollTo(0, targetPosition);\n      }\n\n      if (hashMode) {\n        window.history.pushState(null, '', targetHref);\n      }\n\n      if (value === undefined) {\n        setActiveHref(targetHref);\n      }\n      onChange && onChange(targetHref);\n    }\n  }, [offset, targetOffset, animation, hashMode, onChange, value]);\n\n  const renderAnchorItems = useCallback((anchorItems: AnchorItem[], level: number = 0): ReactNode => {\n    return (<>\n      {anchorItems.map((item) => {\n        const targetHref = hashMode ? `#${item.href.replace(/^#/, '')}` : item.href;\n        return (\n          <div key={targetHref}>\n            <div onClick={(e) => handleClick(e, targetHref)}>\n              {typeof item.content === 'function'\n                ? item.content(value !== undefined ? value === targetHref : activeHref === targetHref, level)\n                : item.content\n              }\n            </div>\n            {item.children && renderAnchorItems(item.children, level + 1)}\n          </div>\n        );\n      })}\n    </>);\n  }, [activeHref, handleClick, value, hashMode]);\n\n  return (\n    <nav className={`ease-anchor ${className}`} style={style}>\n      {renderAnchorItems(items)}\n    </nav>\n  );\n};\n\nexport default EaseAnchor;"],"names":["useState","useRef","useCallback","useEffect"],"mappings":"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"}